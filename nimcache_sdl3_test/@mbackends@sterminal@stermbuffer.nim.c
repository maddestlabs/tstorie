/* Generated by Nim Compiler v2.2.6 */
/* Compiled for: Linux, amd64, gcc */
/* Command for C compiler:
   gcc -c  -w -fmax-errors=3 -fno-strict-aliasing -pthread -I/workspaces/telestorie/lib   -I/home/codespace/.choosenim/toolchains/nim-2.2.6/lib -I/workspaces/telestorie -o /workspaces/telestorie/nimcache_sdl3_test/@mbackends@sterminal@stermbuffer.nim.c.o /workspaces/telestorie/nimcache_sdl3_test/@mbackends@sterminal@stermbuffer.nim.c */
#define NIM_INTBITS 64

#include "nimbase.h"
#include <string.h>
#undef LANGUAGE_C
#undef MIPSEB
#undef MIPSEL
#undef PPC
#undef R3000
#undef R4000
#undef i386
#undef linux
#undef mips
#undef near
#undef far
#undef powerpc
#undef unix
#define nimfr_(proc, file) \
  TFrame FR_; \
  FR_.procname = proc; FR_.filename = file; FR_.line = 0; FR_.len = 0; nimFrame(&FR_);

#define nimln_(n) \
  FR_.line = n;

#define nimlf_(n, file) \
  FR_.line = n; FR_.filename = file;

typedef struct tyObject_TermBuffer__a0me0i7S30c79coeAcFBkWw tyObject_TermBuffer__a0me0i7S30c79coeAcFBkWw;
typedef struct NimStrPayload NimStrPayload;
typedef struct NimStringV2 NimStringV2;
typedef struct tyObject_Style__UURjArTrf2wmcCbN5MncAQ tyObject_Style__UURjArTrf2wmcCbN5MncAQ;
typedef struct tyObject_Color__TZLGUfQjHRBnaB3m3yIxqQ tyObject_Color__TZLGUfQjHRBnaB3m3yIxqQ;
typedef struct tyObject_HSlice__lHgNVhT9csv0Ntz6xvKK2dA tyObject_HSlice__lHgNVhT9csv0Ntz6xvKK2dA;
typedef struct tySequence__hETDgeXECLenIIi9aRQgjOA tySequence__hETDgeXECLenIIi9aRQgjOA;
typedef struct tySequence__hETDgeXECLenIIi9aRQgjOA_Content tySequence__hETDgeXECLenIIi9aRQgjOA_Content;
typedef struct tyObject_Cell__cmvwxiDU9cRtyqddD9c1iMTA tyObject_Cell__cmvwxiDU9cRtyqddD9c1iMTA;
typedef struct tyTuple__hSHiEU6uEtL7soi1F4tKCg tyTuple__hSHiEU6uEtL7soi1F4tKCg;
typedef struct tyTuple__hU79ak4NYUdNYnRLUvBkfpg tyTuple__hU79ak4NYUdNYnRLUvBkfpg;
struct NimStrPayload {
	NI cap;
	NIM_CHAR data[SEQ_DECL_SIZE];
};
struct NimStringV2 {
	NI len;
	NimStrPayload* p;
};
struct tyObject_Color__TZLGUfQjHRBnaB3m3yIxqQ {
	NU8 r;
	NU8 g;
	NU8 b;
};
struct tyObject_Style__UURjArTrf2wmcCbN5MncAQ {
	tyObject_Color__TZLGUfQjHRBnaB3m3yIxqQ fg;
	tyObject_Color__TZLGUfQjHRBnaB3m3yIxqQ bg;
	NIM_BOOL bold;
	NIM_BOOL underline;
	NIM_BOOL italic;
	NIM_BOOL dim;
};
struct tyObject_HSlice__lHgNVhT9csv0Ntz6xvKK2dA {
	NI a;
	NI b;
};
struct tySequence__hETDgeXECLenIIi9aRQgjOA {
  NI len; tySequence__hETDgeXECLenIIi9aRQgjOA_Content* p;
};
struct tyObject_TermBuffer__a0me0i7S30c79coeAcFBkWw {
	NI width;
	NI height;
	tySequence__hETDgeXECLenIIi9aRQgjOA cells;
	NI clipX;
	NI clipY;
	NI clipW;
	NI clipH;
	NI offsetX;
	NI offsetY;
};
struct tyObject_Cell__cmvwxiDU9cRtyqddD9c1iMTA {
	NimStringV2 ch;
	tyObject_Style__UURjArTrf2wmcCbN5MncAQ style;
};
struct tyTuple__hSHiEU6uEtL7soi1F4tKCg {
	NU8 Field0;
	NU8 Field1;
	NU8 Field2;
};
struct tyTuple__hU79ak4NYUdNYnRLUvBkfpg {
	NimStringV2 Field0;
	tyObject_Style__UURjArTrf2wmcCbN5MncAQ Field1;
};
struct tySequence__hETDgeXECLenIIi9aRQgjOA_Content { NI cap; tyObject_Cell__cmvwxiDU9cRtyqddD9c1iMTA data[SEQ_DECL_SIZE]; };
N_LIB_PRIVATE N_NOINLINE(void, raiseIndexError2)(NI i_p0, NI n_p1);
N_LIB_PRIVATE N_NIMCALL(void, eqsink___system_u2716)(NimStringV2* dest_p0, NimStringV2 src_p1);
N_LIB_PRIVATE N_NIMCALL(NimStringV2, nimCharToStr)(NIM_CHAR x_p0);
N_LIB_PRIVATE N_NOINLINE(void, raiseOverflow)(void);
static N_INLINE(NimStringV2, X5BX5D___pureZstrutils_u1291)(NimStringV2 s_p0, tyObject_HSlice__lHgNVhT9csv0Ntz6xvKK2dA x_p1);
N_NIMCALL(NimStringV2, mnewString)(NI len_p0);
N_LIB_PRIVATE N_NOINLINE(void, raiseRangeErrorI)(NI64 i_p0, NI64 a_p1, NI64 b_p2);
static N_INLINE(void, nimPrepareStrMutationV2)(NimStringV2* s_p0);
N_LIB_PRIVATE N_NIMCALL(void, nimPrepareStrMutationImpl__system_u2459)(NimStringV2* s_p0);
static N_INLINE(void, nimFrame)(TFrame* s_p0);
N_LIB_PRIVATE N_NOINLINE(void, callDepthLimitReached__system_u4643)(void);
static N_INLINE(void, popFrame)(void);
static N_INLINE(tyObject_HSlice__lHgNVhT9csv0Ntz6xvKK2dA, dotdot___stdZstrbasics_u48)(NI a_p0, NI b_p1);
static N_INLINE(void, eqdestroy___system_u281)(NimStringV2 x_p0);
N_LIB_PRIVATE N_NIMCALL(void, write__backendsZterminalZtermbuffer_u219)(tyObject_TermBuffer__a0me0i7S30c79coeAcFBkWw* tb_p0, NI x_p1, NI y_p2, NimStringV2 ch_p3, tyObject_Style__UURjArTrf2wmcCbN5MncAQ style_p4);
static N_INLINE(void, nimZeroMem)(void* p_p0, NI size_p1);
static N_INLINE(void, nimSetMem__systemZmemory_u7)(void* a_p0, int v_p1, NI size_p2);
static N_INLINE(NIM_BOOL*, nimErrorFlag)(void);
N_LIB_PRIVATE N_NIMCALL(void, eqsink___backendsZterminalZtermbuffer_u116)(tyObject_Cell__cmvwxiDU9cRtyqddD9c1iMTA* dest_p0, tyObject_Cell__cmvwxiDU9cRtyqddD9c1iMTA* src_p1);
N_LIB_PRIVATE N_NIMCALL(NimStringV2, eqdup___system_u2713)(NimStringV2 src_p0);
N_LIB_PRIVATE N_NIMCALL(tyObject_Style__UURjArTrf2wmcCbN5MncAQ, eqdup___srcZtypes_u76)(tyObject_Style__UURjArTrf2wmcCbN5MncAQ src_p0);
N_LIB_PRIVATE N_NIMCALL(NI, getCharDisplayWidth__srcZcharwidth_u1)(NimStringV2 ch_p0);
N_LIB_PRIVATE N_NOCONV(void, deallocShared)(void* p_p0);
N_LIB_PRIVATE N_NIMCALL(void, eqsink___backendsZterminalZtermbuffer_u170)(tySequence__hETDgeXECLenIIi9aRQgjOA* dest_p0, tySequence__hETDgeXECLenIIi9aRQgjOA src_p1);
N_LIB_PRIVATE N_NIMCALL(tySequence__hETDgeXECLenIIi9aRQgjOA, newSeq__backendsZterminalZtermbuffer_u24)(NI len_p0);
N_LIB_PRIVATE N_NIMCALL(tyObject_Color__TZLGUfQjHRBnaB3m3yIxqQ, white__srcZtypes_u59)(void);
N_LIB_PRIVATE N_NIMCALL(tyObject_Color__TZLGUfQjHRBnaB3m3yIxqQ, black__srcZtypes_u45)(void);
N_LIB_PRIVATE N_NIMCALL(void, eqwasMoved___system_u2707)(NimStringV2* dest_p0);
N_LIB_PRIVATE N_NIMCALL(void, eqcopy___system_u2710)(NimStringV2* dest_p0, NimStringV2 src_p1);
N_LIB_PRIVATE N_NIMCALL(void, eqcopy___backendsZterminalZtermbuffer_u110)(tyObject_Cell__cmvwxiDU9cRtyqddD9c1iMTA* dest_p0, tyObject_Cell__cmvwxiDU9cRtyqddD9c1iMTA* src_p1);
N_LIB_PRIVATE N_NIMCALL(void, eqwasMoved___backendsZterminalZtermbuffer_u104)(tyObject_Cell__cmvwxiDU9cRtyqddD9c1iMTA* dest_p0);
N_LIB_PRIVATE N_NIMCALL(void, eqdestroy___backendsZterminalZtermbuffer_u107)(tyObject_Cell__cmvwxiDU9cRtyqddD9c1iMTA* dest_p0);
static const struct {
  NI cap; NIM_CHAR data[0+1];
} TM__YUEZm6l2D5ui6TQWDCivXQ_2 = { 0 | NIM_STRLIT_FLAG, "" };
static const NimStringV2 TM__YUEZm6l2D5ui6TQWDCivXQ_3 = {0, (NimStrPayload*)&TM__YUEZm6l2D5ui6TQWDCivXQ_2};
static const struct {
  NI cap; NIM_CHAR data[1+1];
} TM__YUEZm6l2D5ui6TQWDCivXQ_14 = { 1 | NIM_STRLIT_FLAG, "\?" };
static const NimStringV2 TM__YUEZm6l2D5ui6TQWDCivXQ_15 = {1, (NimStrPayload*)&TM__YUEZm6l2D5ui6TQWDCivXQ_14};
static const struct {
  NI cap; NIM_CHAR data[1+1];
} TM__YUEZm6l2D5ui6TQWDCivXQ_24 = { 1 | NIM_STRLIT_FLAG, " " };
static const NimStringV2 TM__YUEZm6l2D5ui6TQWDCivXQ_25 = {1, (NimStrPayload*)&TM__YUEZm6l2D5ui6TQWDCivXQ_24};
static const NimStringV2 TM__YUEZm6l2D5ui6TQWDCivXQ_29 = {1, (NimStrPayload*)&TM__YUEZm6l2D5ui6TQWDCivXQ_24};
static const NimStringV2 TM__YUEZm6l2D5ui6TQWDCivXQ_31 = {0, (NimStrPayload*)&TM__YUEZm6l2D5ui6TQWDCivXQ_2};
static const NimStringV2 TM__YUEZm6l2D5ui6TQWDCivXQ_37 = {1, (NimStrPayload*)&TM__YUEZm6l2D5ui6TQWDCivXQ_24};
static const NimStringV2 TM__YUEZm6l2D5ui6TQWDCivXQ_39 = {1, (NimStrPayload*)&TM__YUEZm6l2D5ui6TQWDCivXQ_24};
static const NimStringV2 TM__YUEZm6l2D5ui6TQWDCivXQ_42 = {1, (NimStrPayload*)&TM__YUEZm6l2D5ui6TQWDCivXQ_24};
extern NIM_THREADVAR TFrame* framePtr__system_u2743;
extern NIM_THREADVAR NIM_BOOL nimInErrorMode__system_u4425;
static N_INLINE(void, nimPrepareStrMutationV2)(NimStringV2* s_p0) {
	{
		NIM_BOOL T3_;
		T3_ = (NIM_BOOL)0;
		T3_ = !(((*s_p0).p == ((NimStrPayload*) NIM_NIL)));
		if (!(T3_)) goto LA4_;
		T3_ = ((NI)((*(*s_p0).p).cap & ((NI)IL64(4611686018427387904))) == ((NI)IL64(4611686018427387904)));
LA4_: ;
		if (!T3_) goto LA5_;
		nimPrepareStrMutationImpl__system_u2459(s_p0);
	}
LA5_: ;
}
static N_INLINE(void, nimFrame)(TFrame* s_p0) {
	{
		if (!(framePtr__system_u2743 == ((TFrame*) NIM_NIL))) goto LA3_;
		(*s_p0).calldepth = ((NI16)0);
	}
	goto LA1_;
LA3_: ;
	{
		(*s_p0).calldepth = (NI16)((*framePtr__system_u2743).calldepth + ((NI16)1));
	}
LA1_: ;
	(*s_p0).prev = framePtr__system_u2743;
	framePtr__system_u2743 = s_p0;
	{
		if (!((*s_p0).calldepth == ((NI16)2000))) goto LA8_;
		callDepthLimitReached__system_u4643();
	}
LA8_: ;
}
static N_INLINE(void, popFrame)(void) {
	framePtr__system_u2743 = (*framePtr__system_u2743).prev;
}
static N_INLINE(NimStringV2, X5BX5D___pureZstrutils_u1291)(NimStringV2 s_p0, tyObject_HSlice__lHgNVhT9csv0Ntz6xvKK2dA x_p1) {
	NimStringV2 result;
	NI a_1;
	NI L_1;
	NI TM__YUEZm6l2D5ui6TQWDCivXQ_5;
	NI TM__YUEZm6l2D5ui6TQWDCivXQ_6;
	nimfr_("[]", "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system/indices.nim");
{	result.len = 0; result.p = NIM_NIL;
	nimlf_(83, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system/indices.nim");	a_1 = x_p1.a;
	nimln_(84);	if (nimSubInt(x_p1.b, a_1, &TM__YUEZm6l2D5ui6TQWDCivXQ_5)) { raiseOverflow(); goto BeforeRet_;
	};
	if (nimAddInt((NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_5), ((NI)1), &TM__YUEZm6l2D5ui6TQWDCivXQ_6)) { raiseOverflow(); goto BeforeRet_;
	};
	L_1 = (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_6);
	nimln_(85);	if ((L_1) < ((NI)0) || (L_1) > ((NI)IL64(9223372036854775807))){ raiseRangeErrorI(L_1, ((NI)0), ((NI)IL64(9223372036854775807))); goto BeforeRet_;
	}
	result = mnewString((L_1));
	{
		NI i_1;
		NI i_2;
		i_1 = (NI)0;
		nimlf_(128, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system/iterators_1.nim");		i_2 = ((NI)0);
		{
			nimln_(129);			while (1) {
				NI TM__YUEZm6l2D5ui6TQWDCivXQ_7;
				NI TM__YUEZm6l2D5ui6TQWDCivXQ_8;
				if (!(i_2 < L_1)) goto LA3;
				nimlf_(86, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system/indices.nim");				i_1 = i_2;
				if (i_1 < 0 || i_1 >= result.len){ raiseIndexError2(i_1,result.len-1); goto BeforeRet_;
				}
				nimPrepareStrMutationV2((&result));
				if (nimAddInt(i_1, a_1, &TM__YUEZm6l2D5ui6TQWDCivXQ_7)) { raiseOverflow(); goto BeforeRet_;
				};
				if ((NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_7) < 0 || (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_7) >= s_p0.len){ raiseIndexError2((NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_7),s_p0.len-1); goto BeforeRet_;
				}
				result.p->data[i_1] = s_p0.p->data[(NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_7)];
				nimlf_(131, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system/iterators_1.nim");				if (nimAddInt(i_2, ((NI)1), &TM__YUEZm6l2D5ui6TQWDCivXQ_8)) { raiseOverflow(); goto BeforeRet_;
				};
				i_2 = (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_8);
			} LA3: ;
		}
	}
	}BeforeRet_: ;
	popFrame();
	return result;
}
static N_INLINE(tyObject_HSlice__lHgNVhT9csv0Ntz6xvKK2dA, dotdot___stdZstrbasics_u48)(NI a_p0, NI b_p1) {
	tyObject_HSlice__lHgNVhT9csv0Ntz6xvKK2dA result;
	nimfr_("..", "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");
	nimlf_(436, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");	result.a = a_p0;
	result.b = b_p1;
	popFrame();
	return result;
}
static N_INLINE(void, eqdestroy___system_u281)(NimStringV2 x_p0) {
	nimfr_("=destroy", "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");
	popFrame();
}
static N_INLINE(void, nimSetMem__systemZmemory_u7)(void* a_p0, int v_p1, NI size_p2) {
	void* T1_;
	T1_ = (void*)0;
	T1_ = memset(a_p0, v_p1, ((size_t) (size_p2)));
}
static N_INLINE(NIM_BOOL*, nimErrorFlag)(void) {
	NIM_BOOL* result;
	result = (&nimInErrorMode__system_u4425);
	return result;
}
static N_INLINE(void, nimZeroMem)(void* p_p0, NI size_p1) {
NIM_BOOL* nimErr_;
{nimErr_ = nimErrorFlag();
	nimSetMem__systemZmemory_u7(p_p0, ((int)0), size_p1);
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	}BeforeRet_: ;
}
N_LIB_PRIVATE N_NIMCALL(void, write__backendsZterminalZtermbuffer_u219)(tyObject_TermBuffer__a0me0i7S30c79coeAcFBkWw* tb_p0, NI x_p1, NI y_p2, NimStringV2 ch_p3, tyObject_Style__UURjArTrf2wmcCbN5MncAQ style_p4) {
	NI adjustedX_1;
	NI TM__YUEZm6l2D5ui6TQWDCivXQ_16;
	NI adjustedY_1;
	NI TM__YUEZm6l2D5ui6TQWDCivXQ_17;
	NI screenX_1;
	NI screenY_1;
	nimfr_("write", "/workspaces/telestorie/backends/terminal/termbuffer.nim");
{	nimlf_(56, "/workspaces/telestorie/backends/terminal/termbuffer.nim");	if (nimAddInt(x_p1, (*tb_p0).offsetX, &TM__YUEZm6l2D5ui6TQWDCivXQ_16)) { raiseOverflow(); goto BeforeRet_;
	};
	adjustedX_1 = (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_16);
	nimln_(57);	if (nimAddInt(y_p2, (*tb_p0).offsetY, &TM__YUEZm6l2D5ui6TQWDCivXQ_17)) { raiseOverflow(); goto BeforeRet_;
	};
	adjustedY_1 = (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_17);
	nimln_(59);	{
		NIM_BOOL T3_;
		NI TM__YUEZm6l2D5ui6TQWDCivXQ_18;
		T3_ = (NIM_BOOL)0;
		T3_ = (adjustedX_1 < (*tb_p0).clipX);
		if (T3_) goto LA4_;
		if (nimAddInt((*tb_p0).clipX, (*tb_p0).clipW, &TM__YUEZm6l2D5ui6TQWDCivXQ_18)) { raiseOverflow(); goto BeforeRet_;
		};
		T3_ = ((NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_18) <= adjustedX_1);
LA4_: ;
		if (!T3_) goto LA5_;
		nimln_(60);		goto BeforeRet_;
	}
LA5_: ;
	nimln_(61);	{
		NIM_BOOL T9_;
		NI TM__YUEZm6l2D5ui6TQWDCivXQ_19;
		T9_ = (NIM_BOOL)0;
		T9_ = (adjustedY_1 < (*tb_p0).clipY);
		if (T9_) goto LA10_;
		if (nimAddInt((*tb_p0).clipY, (*tb_p0).clipH, &TM__YUEZm6l2D5ui6TQWDCivXQ_19)) { raiseOverflow(); goto BeforeRet_;
		};
		T9_ = ((NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_19) <= adjustedY_1);
LA10_: ;
		if (!T9_) goto LA11_;
		nimln_(62);		goto BeforeRet_;
	}
LA11_: ;
	nimln_(64);	screenX_1 = adjustedX_1;
	nimln_(65);	screenY_1 = adjustedY_1;
	nimln_(67);	{
		NIM_BOOL T15_;
		NIM_BOOL T16_;
		NIM_BOOL T17_;
		T15_ = (NIM_BOOL)0;
		T16_ = (NIM_BOOL)0;
		T17_ = (NIM_BOOL)0;
		T17_ = (screenX_1 < ((NI)0));
		if (T17_) goto LA18_;
		T17_ = ((*tb_p0).width <= screenX_1);
LA18_: ;
		T16_ = T17_;
		if (T16_) goto LA19_;
		T16_ = (screenY_1 < ((NI)0));
LA19_: ;
		T15_ = T16_;
		if (T15_) goto LA20_;
		T15_ = ((*tb_p0).height <= screenY_1);
LA20_: ;
		if (!T15_) goto LA21_;
		nimln_(68);		goto BeforeRet_;
	}
LA21_: ;
	nimln_(70);	{
		NIM_BOOL T25_;
		NIM_BOOL T26_;
		NIM_BOOL T27_;
		NimStringV2 colontmpD_;
		tyObject_Style__UURjArTrf2wmcCbN5MncAQ colontmpD__2;
		NI idx_1;
		NI TM__YUEZm6l2D5ui6TQWDCivXQ_20;
		NI TM__YUEZm6l2D5ui6TQWDCivXQ_21;
		tyObject_Cell__cmvwxiDU9cRtyqddD9c1iMTA T33_;
		T25_ = (NIM_BOOL)0;
		T26_ = (NIM_BOOL)0;
		T27_ = (NIM_BOOL)0;
		T27_ = (((NI)0) <= screenX_1);
		if (!(T27_)) goto LA28_;
		T27_ = (screenX_1 < (*tb_p0).width);
LA28_: ;
		T26_ = T27_;
		if (!(T26_)) goto LA29_;
		T26_ = (((NI)0) <= screenY_1);
LA29_: ;
		T25_ = T26_;
		if (!(T25_)) goto LA30_;
		T25_ = (screenY_1 < (*tb_p0).height);
LA30_: ;
		if (!T25_) goto LA31_;
		colontmpD_.len = 0; colontmpD_.p = NIM_NIL;
		nimZeroMem((void*)(&colontmpD__2), sizeof(tyObject_Style__UURjArTrf2wmcCbN5MncAQ));
		nimln_(71);		if (nimMulInt(screenY_1, (*tb_p0).width, &TM__YUEZm6l2D5ui6TQWDCivXQ_20)) { raiseOverflow(); goto BeforeRet_;
		};
		if (nimAddInt((NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_20), screenX_1, &TM__YUEZm6l2D5ui6TQWDCivXQ_21)) { raiseOverflow(); goto BeforeRet_;
		};
		idx_1 = (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_21);
		nimlf_(934, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");		if (idx_1 < 0 || idx_1 >= (*tb_p0).cells.len){ raiseIndexError2(idx_1,(*tb_p0).cells.len-1); goto BeforeRet_;
		}
		nimlf_(72, "/workspaces/telestorie/backends/terminal/termbuffer.nim");		nimlf_(1699, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");		colontmpD_ = eqdup___system_u2713(ch_p3);
		T33_.ch = colontmpD_;
		nimlf_(72, "/workspaces/telestorie/backends/terminal/termbuffer.nim");		nimlf_(74, "/workspaces/telestorie/src/types.nim");		colontmpD__2 = eqdup___srcZtypes_u76(style_p4);
		T33_.style = colontmpD__2;
		nimlf_(934, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");		eqsink___backendsZterminalZtermbuffer_u116((&(*tb_p0).cells.p->data[idx_1]), (&T33_));
	}
LA31_: ;
	}BeforeRet_: ;
	popFrame();
}
N_LIB_PRIVATE N_NIMCALL(void, writeText__backendsZterminalZtermbuffer_u230)(tyObject_TermBuffer__a0me0i7S30c79coeAcFBkWw* tb_p0, NI x_p1, NI y_p2, NimStringV2 text_p3, tyObject_Style__UURjArTrf2wmcCbN5MncAQ style_p4) {
	NI currentX_1;
	NI i_1;
NIM_BOOL* nimErr_;
	nimfr_("writeText", "/workspaces/telestorie/backends/terminal/termbuffer.nim");
{nimErr_ = nimErrorFlag();
	nimlf_(77, "/workspaces/telestorie/backends/terminal/termbuffer.nim");	currentX_1 = x_p1;
	nimln_(78);	i_1 = ((NI)0);
	{
		nimln_(79);		while (1) {
			NimStringV2 ch_1;
			NI b_1;
			NI charLen_1;
			NI displayWidth_1;
			NI TM__YUEZm6l2D5ui6TQWDCivXQ_26;
			NI TM__YUEZm6l2D5ui6TQWDCivXQ_27;
			if (!(i_1 < text_p3.len)) goto LA2;
			ch_1.len = 0; ch_1.p = NIM_NIL;
			nimln_(80);			if (i_1 < 0 || i_1 >= text_p3.len){ raiseIndexError2(i_1,text_p3.len-1); goto BeforeRet_;
			}
			b_1 = ((NU8)(text_p3.p->data[i_1]));
			nimln_(81);			charLen_1 = ((NI)1);
			nimln_(82);			ch_1 = TM__YUEZm6l2D5ui6TQWDCivXQ_3;
			nimln_(85);			{
				NimStringV2 T7_;
				if (!((NI)(b_1 & ((NI)128)) == ((NI)0))) goto LA5_;
				nimlf_(1699, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");				nimlf_(86, "/workspaces/telestorie/backends/terminal/termbuffer.nim");				if (i_1 < 0 || i_1 >= text_p3.len){ raiseIndexError2(i_1,text_p3.len-1); goto BeforeRet_;
				}
				T7_.len = 0; T7_.p = NIM_NIL;
				T7_ = nimCharToStr(text_p3.p->data[i_1]);
				nimlf_(1699, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");				eqsink___system_u2716((&ch_1), T7_);
			}
			goto LA3_;
LA5_: ;
			{
				NIM_BOOL T9_;
				NI TM__YUEZm6l2D5ui6TQWDCivXQ_4;
				NI TM__YUEZm6l2D5ui6TQWDCivXQ_9;
				tyObject_HSlice__lHgNVhT9csv0Ntz6xvKK2dA T13_;
				NimStringV2 T14_;
				nimlf_(87, "/workspaces/telestorie/backends/terminal/termbuffer.nim");				T9_ = (NIM_BOOL)0;
				T9_ = ((NI)(b_1 & ((NI)224)) == ((NI)192));
				if (!(T9_)) goto LA10_;
				if (nimAddInt(i_1, ((NI)1), &TM__YUEZm6l2D5ui6TQWDCivXQ_4)) { raiseOverflow(); goto BeforeRet_;
				};
				T9_ = ((NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_4) < text_p3.len);
LA10_: ;
				if (!T9_) goto LA11_;
				nimlf_(1699, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");				nimlf_(88, "/workspaces/telestorie/backends/terminal/termbuffer.nim");				if (nimAddInt(i_1, ((NI)1), &TM__YUEZm6l2D5ui6TQWDCivXQ_9)) { raiseOverflow(); goto BeforeRet_;
				};
				T13_ = dotdot___stdZstrbasics_u48(i_1, (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_9));
				T14_.len = 0; T14_.p = NIM_NIL;
				T14_ = X5BX5D___pureZstrutils_u1291(text_p3, T13_);
				if (NIM_UNLIKELY(*nimErr_)) {eqdestroy___system_u281(T14_); goto BeforeRet_;}
				nimlf_(1699, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");				eqsink___system_u2716((&ch_1), T14_);
				nimlf_(89, "/workspaces/telestorie/backends/terminal/termbuffer.nim");				charLen_1 = ((NI)2);
			}
			goto LA3_;
LA11_: ;
			{
				NIM_BOOL T16_;
				NI TM__YUEZm6l2D5ui6TQWDCivXQ_10;
				NI TM__YUEZm6l2D5ui6TQWDCivXQ_11;
				tyObject_HSlice__lHgNVhT9csv0Ntz6xvKK2dA T20_;
				NimStringV2 T21_;
				nimln_(90);				T16_ = (NIM_BOOL)0;
				T16_ = ((NI)(b_1 & ((NI)240)) == ((NI)224));
				if (!(T16_)) goto LA17_;
				if (nimAddInt(i_1, ((NI)2), &TM__YUEZm6l2D5ui6TQWDCivXQ_10)) { raiseOverflow(); goto BeforeRet_;
				};
				T16_ = ((NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_10) < text_p3.len);
LA17_: ;
				if (!T16_) goto LA18_;
				nimlf_(1699, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");				nimlf_(91, "/workspaces/telestorie/backends/terminal/termbuffer.nim");				if (nimAddInt(i_1, ((NI)2), &TM__YUEZm6l2D5ui6TQWDCivXQ_11)) { raiseOverflow(); goto BeforeRet_;
				};
				T20_ = dotdot___stdZstrbasics_u48(i_1, (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_11));
				T21_.len = 0; T21_.p = NIM_NIL;
				T21_ = X5BX5D___pureZstrutils_u1291(text_p3, T20_);
				if (NIM_UNLIKELY(*nimErr_)) {eqdestroy___system_u281(T21_); goto BeforeRet_;}
				nimlf_(1699, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");				eqsink___system_u2716((&ch_1), T21_);
				nimlf_(92, "/workspaces/telestorie/backends/terminal/termbuffer.nim");				charLen_1 = ((NI)3);
			}
			goto LA3_;
LA18_: ;
			{
				NIM_BOOL T23_;
				NI TM__YUEZm6l2D5ui6TQWDCivXQ_12;
				NI TM__YUEZm6l2D5ui6TQWDCivXQ_13;
				tyObject_HSlice__lHgNVhT9csv0Ntz6xvKK2dA T27_;
				NimStringV2 T28_;
				nimln_(93);				T23_ = (NIM_BOOL)0;
				T23_ = ((NI)(b_1 & ((NI)248)) == ((NI)240));
				if (!(T23_)) goto LA24_;
				if (nimAddInt(i_1, ((NI)3), &TM__YUEZm6l2D5ui6TQWDCivXQ_12)) { raiseOverflow(); goto BeforeRet_;
				};
				T23_ = ((NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_12) < text_p3.len);
LA24_: ;
				if (!T23_) goto LA25_;
				nimlf_(1699, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");				nimlf_(94, "/workspaces/telestorie/backends/terminal/termbuffer.nim");				if (nimAddInt(i_1, ((NI)3), &TM__YUEZm6l2D5ui6TQWDCivXQ_13)) { raiseOverflow(); goto BeforeRet_;
				};
				T27_ = dotdot___stdZstrbasics_u48(i_1, (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_13));
				T28_.len = 0; T28_.p = NIM_NIL;
				T28_ = X5BX5D___pureZstrutils_u1291(text_p3, T27_);
				if (NIM_UNLIKELY(*nimErr_)) {eqdestroy___system_u281(T28_); goto BeforeRet_;}
				nimlf_(1699, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");				eqsink___system_u2716((&ch_1), T28_);
				nimlf_(95, "/workspaces/telestorie/backends/terminal/termbuffer.nim");				charLen_1 = ((NI)4);
			}
			goto LA3_;
LA25_: ;
			{
				nimlf_(1699, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");				eqsink___system_u2716((&ch_1), TM__YUEZm6l2D5ui6TQWDCivXQ_15);
			}
LA3_: ;
			nimlf_(99, "/workspaces/telestorie/backends/terminal/termbuffer.nim");			write__backendsZterminalZtermbuffer_u219(tb_p0, currentX_1, y_p2, ch_1, style_p4);
			if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
			nimln_(102);			displayWidth_1 = getCharDisplayWidth__srcZcharwidth_u1(ch_1);
			if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
			nimln_(105);			{
				NIM_BOOL T32_;
				NI TM__YUEZm6l2D5ui6TQWDCivXQ_22;
				NI TM__YUEZm6l2D5ui6TQWDCivXQ_23;
				T32_ = (NIM_BOOL)0;
				T32_ = (displayWidth_1 == ((NI)2));
				if (!(T32_)) goto LA33_;
				if (nimAddInt(currentX_1, ((NI)1), &TM__YUEZm6l2D5ui6TQWDCivXQ_22)) { raiseOverflow(); goto BeforeRet_;
				};
				T32_ = ((NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_22) < (*tb_p0).width);
LA33_: ;
				if (!T32_) goto LA34_;
				nimln_(106);				if (nimAddInt(currentX_1, ((NI)1), &TM__YUEZm6l2D5ui6TQWDCivXQ_23)) { raiseOverflow(); goto BeforeRet_;
				};
				write__backendsZterminalZtermbuffer_u219(tb_p0, (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_23), y_p2, TM__YUEZm6l2D5ui6TQWDCivXQ_25, style_p4);
				if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
			}
LA34_: ;
			nimln_(108);			if (nimAddInt(currentX_1, displayWidth_1, &TM__YUEZm6l2D5ui6TQWDCivXQ_26)) { raiseOverflow(); goto BeforeRet_;
			};
			currentX_1 = (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_26);
			nimln_(109);			if (nimAddInt(i_1, charLen_1, &TM__YUEZm6l2D5ui6TQWDCivXQ_27)) { raiseOverflow(); goto BeforeRet_;
			};
			i_1 = (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_27);
			nimlf_(394, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");			if (ch_1.p && !(ch_1.p->cap & NIM_STRLIT_FLAG)) {
 deallocShared(ch_1.p);
}
		} LA2: ;
	}
	}BeforeRet_: ;
	popFrame();
}
N_LIB_PRIVATE N_NIMCALL(void, newTermBuffer__backendsZterminalZtermbuffer_u4)(NI w_p0, NI h_p1, tyObject_TermBuffer__a0me0i7S30c79coeAcFBkWw* Result) {
	NI TM__YUEZm6l2D5ui6TQWDCivXQ_28;
	tySequence__hETDgeXECLenIIi9aRQgjOA T1_;
	tyObject_Style__UURjArTrf2wmcCbN5MncAQ defaultStyle_1;
NIM_BOOL* nimErr_;
	nimfr_("newTermBuffer", "/workspaces/telestorie/backends/terminal/termbuffer.nim");
{nimErr_ = nimErrorFlag();
	nimZeroMem((void*)Result, sizeof(tyObject_TermBuffer__a0me0i7S30c79coeAcFBkWw));
	nimlf_(21, "/workspaces/telestorie/backends/terminal/termbuffer.nim");	(*Result).width = w_p0;
	nimln_(22);	(*Result).height = h_p1;
	nimlf_(651, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");	nimlf_(23, "/workspaces/telestorie/backends/terminal/termbuffer.nim");	if (nimMulInt(w_p0, h_p1, &TM__YUEZm6l2D5ui6TQWDCivXQ_28)) { raiseOverflow(); goto BeforeRet_;
	};
	if (((NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_28)) < ((NI)0) || ((NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_28)) > ((NI)IL64(9223372036854775807))){ raiseRangeErrorI((NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_28), ((NI)0), ((NI)IL64(9223372036854775807))); goto BeforeRet_;
	}
	T1_.len = 0; T1_.p = NIM_NIL;
	T1_ = newSeq__backendsZterminalZtermbuffer_u24(((NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_28)));
	nimlf_(651, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");	eqsink___backendsZterminalZtermbuffer_u170((&(*Result).cells), T1_);
	nimlf_(24, "/workspaces/telestorie/backends/terminal/termbuffer.nim");	(*Result).clipX = ((NI)0);
	nimln_(25);	(*Result).clipY = ((NI)0);
	nimln_(26);	(*Result).clipW = w_p0;
	nimln_(27);	(*Result).clipH = h_p1;
	nimln_(28);	(*Result).offsetX = ((NI)0);
	nimln_(29);	(*Result).offsetY = ((NI)0);
	nimln_(30);	nimZeroMem((void*)(&defaultStyle_1), sizeof(tyObject_Style__UURjArTrf2wmcCbN5MncAQ));
	defaultStyle_1.fg = white__srcZtypes_u59();
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	defaultStyle_1.bg = black__srcZtypes_u45();
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	defaultStyle_1.bold = NIM_FALSE;
	{
		NI i_1;
		NI colontmp_;
		NI T3_;
		NI i_2;
		i_1 = (NI)0;
		colontmp_ = (NI)0;
		nimlf_(126, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system/iterators_1.nim");		nimlf_(31, "/workspaces/telestorie/backends/terminal/termbuffer.nim");		T3_ = (*Result).cells.len;
		colontmp_ = T3_;
		nimlf_(128, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system/iterators_1.nim");		i_2 = ((NI)0);
		{
			nimln_(129);			while (1) {
				tyObject_Style__UURjArTrf2wmcCbN5MncAQ colontmpD_;
				tyObject_Cell__cmvwxiDU9cRtyqddD9c1iMTA T6_;
				NI TM__YUEZm6l2D5ui6TQWDCivXQ_30;
				if (!(i_2 < colontmp_)) goto LA5;
				nimZeroMem((void*)(&colontmpD_), sizeof(tyObject_Style__UURjArTrf2wmcCbN5MncAQ));
				nimlf_(31, "/workspaces/telestorie/backends/terminal/termbuffer.nim");				i_1 = i_2;
				nimlf_(934, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");				if (i_1 < 0 || i_1 >= (*Result).cells.len){ raiseIndexError2(i_1,(*Result).cells.len-1); goto BeforeRet_;
				}
				T6_.ch = TM__YUEZm6l2D5ui6TQWDCivXQ_29;
				nimlf_(32, "/workspaces/telestorie/backends/terminal/termbuffer.nim");				nimlf_(74, "/workspaces/telestorie/src/types.nim");				colontmpD_ = eqdup___srcZtypes_u76(defaultStyle_1);
				T6_.style = colontmpD_;
				nimlf_(934, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");				eqsink___backendsZterminalZtermbuffer_u116((&(*Result).cells.p->data[i_1]), (&T6_));
				nimlf_(131, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system/iterators_1.nim");				if (nimAddInt(i_2, ((NI)1), &TM__YUEZm6l2D5ui6TQWDCivXQ_30)) { raiseOverflow(); goto BeforeRet_;
				};
				i_2 = (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_30);
			} LA5: ;
		}
	}
	}BeforeRet_: ;
	popFrame();
}
N_LIB_PRIVATE N_NIMCALL(void, clearTransparent__backendsZterminalZtermbuffer_u340)(tyObject_TermBuffer__a0me0i7S30c79coeAcFBkWw* tb_p0) {
	tyObject_Style__UURjArTrf2wmcCbN5MncAQ defaultStyle_1;
NIM_BOOL* nimErr_;
	nimfr_("clearTransparent", "/workspaces/telestorie/backends/terminal/termbuffer.nim");
{nimErr_ = nimErrorFlag();
	nimlf_(125, "/workspaces/telestorie/backends/terminal/termbuffer.nim");	nimZeroMem((void*)(&defaultStyle_1), sizeof(tyObject_Style__UURjArTrf2wmcCbN5MncAQ));
	defaultStyle_1.fg = white__srcZtypes_u59();
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	defaultStyle_1.bg = black__srcZtypes_u45();
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	defaultStyle_1.bold = NIM_FALSE;
	{
		NI i_1;
		NI colontmp_;
		NI T2_;
		NI i_2;
		i_1 = (NI)0;
		colontmp_ = (NI)0;
		nimlf_(126, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system/iterators_1.nim");		nimlf_(126, "/workspaces/telestorie/backends/terminal/termbuffer.nim");		T2_ = (*tb_p0).cells.len;
		colontmp_ = T2_;
		nimlf_(128, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system/iterators_1.nim");		i_2 = ((NI)0);
		{
			nimln_(129);			while (1) {
				tyObject_Style__UURjArTrf2wmcCbN5MncAQ colontmpD_;
				tyObject_Cell__cmvwxiDU9cRtyqddD9c1iMTA T5_;
				NI TM__YUEZm6l2D5ui6TQWDCivXQ_32;
				if (!(i_2 < colontmp_)) goto LA4;
				nimZeroMem((void*)(&colontmpD_), sizeof(tyObject_Style__UURjArTrf2wmcCbN5MncAQ));
				nimlf_(126, "/workspaces/telestorie/backends/terminal/termbuffer.nim");				i_1 = i_2;
				nimlf_(934, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");				if (i_1 < 0 || i_1 >= (*tb_p0).cells.len){ raiseIndexError2(i_1,(*tb_p0).cells.len-1); goto BeforeRet_;
				}
				T5_.ch = TM__YUEZm6l2D5ui6TQWDCivXQ_31;
				nimlf_(127, "/workspaces/telestorie/backends/terminal/termbuffer.nim");				nimlf_(74, "/workspaces/telestorie/src/types.nim");				colontmpD_ = eqdup___srcZtypes_u76(defaultStyle_1);
				T5_.style = colontmpD_;
				nimlf_(934, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");				eqsink___backendsZterminalZtermbuffer_u116((&(*tb_p0).cells.p->data[i_1]), (&T5_));
				nimlf_(131, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system/iterators_1.nim");				if (nimAddInt(i_2, ((NI)1), &TM__YUEZm6l2D5ui6TQWDCivXQ_32)) { raiseOverflow(); goto BeforeRet_;
				};
				i_2 = (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_32);
			} LA4: ;
		}
	}
	}BeforeRet_: ;
	popFrame();
}
N_LIB_PRIVATE N_NIMCALL(void, fillRect__backendsZterminalZtermbuffer_u307)(tyObject_TermBuffer__a0me0i7S30c79coeAcFBkWw* tb_p0, NI x_p1, NI y_p2, NI w_p3, NI h_p4, NimStringV2 ch_p5, tyObject_Style__UURjArTrf2wmcCbN5MncAQ style_p6) {
NIM_BOOL* nimErr_;
	nimfr_("fillRect", "/workspaces/telestorie/backends/terminal/termbuffer.nim");
{nimErr_ = nimErrorFlag();
	{
		NI dy_1;
		NI i_1;
		dy_1 = (NI)0;
		nimln_(128);		i_1 = ((NI)0);
		{
			nimln_(129);			while (1) {
				NI TM__YUEZm6l2D5ui6TQWDCivXQ_36;
				if (!(i_1 < h_p4)) goto LA3;
				nimlf_(113, "/workspaces/telestorie/backends/terminal/termbuffer.nim");				dy_1 = i_1;
				{
					NI dx_1;
					NI i_2;
					dx_1 = (NI)0;
					nimlf_(128, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system/iterators_1.nim");					i_2 = ((NI)0);
					{
						nimln_(129);						while (1) {
							NI TM__YUEZm6l2D5ui6TQWDCivXQ_33;
							NI TM__YUEZm6l2D5ui6TQWDCivXQ_34;
							NI TM__YUEZm6l2D5ui6TQWDCivXQ_35;
							if (!(i_2 < w_p3)) goto LA6;
							nimlf_(114, "/workspaces/telestorie/backends/terminal/termbuffer.nim");							dx_1 = i_2;
							nimln_(115);							if (nimAddInt(x_p1, dx_1, &TM__YUEZm6l2D5ui6TQWDCivXQ_33)) { raiseOverflow(); goto BeforeRet_;
							};
							if (nimAddInt(y_p2, dy_1, &TM__YUEZm6l2D5ui6TQWDCivXQ_34)) { raiseOverflow(); goto BeforeRet_;
							};
							write__backendsZterminalZtermbuffer_u219(tb_p0, (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_33), (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_34), ch_p5, style_p6);
							if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
							nimlf_(131, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system/iterators_1.nim");							if (nimAddInt(i_2, ((NI)1), &TM__YUEZm6l2D5ui6TQWDCivXQ_35)) { raiseOverflow(); goto BeforeRet_;
							};
							i_2 = (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_35);
						} LA6: ;
					}
				}
				if (nimAddInt(i_1, ((NI)1), &TM__YUEZm6l2D5ui6TQWDCivXQ_36)) { raiseOverflow(); goto BeforeRet_;
				};
				i_1 = (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_36);
			} LA3: ;
		}
	}
	}BeforeRet_: ;
	popFrame();
}
N_LIB_PRIVATE N_NIMCALL(void, clear__backendsZterminalZtermbuffer_u325)(tyObject_TermBuffer__a0me0i7S30c79coeAcFBkWw* tb_p0, tyTuple__hSHiEU6uEtL7soi1F4tKCg bgColor_p1) {
	tyObject_Style__UURjArTrf2wmcCbN5MncAQ defaultStyle_1;
NIM_BOOL* nimErr_;
	nimfr_("clear", "/workspaces/telestorie/backends/terminal/termbuffer.nim");
{nimErr_ = nimErrorFlag();
	nimlf_(119, "/workspaces/telestorie/backends/terminal/termbuffer.nim");	nimZeroMem((void*)(&defaultStyle_1), sizeof(tyObject_Style__UURjArTrf2wmcCbN5MncAQ));
	defaultStyle_1.fg = white__srcZtypes_u59();
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	defaultStyle_1.bg.r = bgColor_p1.Field0;
	defaultStyle_1.bg.g = bgColor_p1.Field1;
	defaultStyle_1.bg.b = bgColor_p1.Field2;
	defaultStyle_1.bold = NIM_FALSE;
	{
		NI i_1;
		NI colontmp_;
		NI T2_;
		NI i_2;
		i_1 = (NI)0;
		colontmp_ = (NI)0;
		nimlf_(126, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system/iterators_1.nim");		nimlf_(120, "/workspaces/telestorie/backends/terminal/termbuffer.nim");		T2_ = (*tb_p0).cells.len;
		colontmp_ = T2_;
		nimlf_(128, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system/iterators_1.nim");		i_2 = ((NI)0);
		{
			nimln_(129);			while (1) {
				tyObject_Style__UURjArTrf2wmcCbN5MncAQ colontmpD_;
				tyObject_Cell__cmvwxiDU9cRtyqddD9c1iMTA T5_;
				NI TM__YUEZm6l2D5ui6TQWDCivXQ_38;
				if (!(i_2 < colontmp_)) goto LA4;
				nimZeroMem((void*)(&colontmpD_), sizeof(tyObject_Style__UURjArTrf2wmcCbN5MncAQ));
				nimlf_(120, "/workspaces/telestorie/backends/terminal/termbuffer.nim");				i_1 = i_2;
				nimlf_(934, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");				if (i_1 < 0 || i_1 >= (*tb_p0).cells.len){ raiseIndexError2(i_1,(*tb_p0).cells.len-1); goto BeforeRet_;
				}
				T5_.ch = TM__YUEZm6l2D5ui6TQWDCivXQ_37;
				nimlf_(121, "/workspaces/telestorie/backends/terminal/termbuffer.nim");				nimlf_(74, "/workspaces/telestorie/src/types.nim");				colontmpD_ = eqdup___srcZtypes_u76(defaultStyle_1);
				T5_.style = colontmpD_;
				nimlf_(934, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");				eqsink___backendsZterminalZtermbuffer_u116((&(*tb_p0).cells.p->data[i_1]), (&T5_));
				nimlf_(131, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system/iterators_1.nim");				if (nimAddInt(i_2, ((NI)1), &TM__YUEZm6l2D5ui6TQWDCivXQ_38)) { raiseOverflow(); goto BeforeRet_;
				};
				i_2 = (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_38);
			} LA4: ;
		}
	}
	}BeforeRet_: ;
	popFrame();
}
N_LIB_PRIVATE N_NIMCALL(void, getCell__backendsZterminalZtermbuffer_u351)(tyObject_TermBuffer__a0me0i7S30c79coeAcFBkWw* tb_p0, NI x_p1, NI y_p2, tyTuple__hU79ak4NYUdNYnRLUvBkfpg* Result) {
	NimStringV2 colontmp_;
	NI idx_1;
	NI TM__YUEZm6l2D5ui6TQWDCivXQ_40;
	NI TM__YUEZm6l2D5ui6TQWDCivXQ_41;
	tyObject_Style__UURjArTrf2wmcCbN5MncAQ defStyle_2;
	tyObject_Style__UURjArTrf2wmcCbN5MncAQ colontmp__6;
	NimStringV2 blitTmp_3;
NIM_BOOL* nimErr_;
	nimfr_("getCell", "/workspaces/telestorie/backends/terminal/termbuffer.nim");
{nimErr_ = nimErrorFlag();
	nimZeroMem((void*)Result, sizeof(tyTuple__hU79ak4NYUdNYnRLUvBkfpg));
	colontmp_.len = 0; colontmp_.p = NIM_NIL;
	nimlf_(131, "/workspaces/telestorie/backends/terminal/termbuffer.nim");	{
		NIM_BOOL T4_;
		NIM_BOOL T5_;
		NIM_BOOL T6_;
		NimStringV2 colontmp__2;
		tyObject_Style__UURjArTrf2wmcCbN5MncAQ defStyle_1;
		tyObject_Style__UURjArTrf2wmcCbN5MncAQ colontmp__3;
		NimStringV2 blitTmp_1;
		T4_ = (NIM_BOOL)0;
		T5_ = (NIM_BOOL)0;
		T6_ = (NIM_BOOL)0;
		T6_ = (x_p1 < ((NI)0));
		if (T6_) goto LA7_;
		T6_ = ((*tb_p0).width <= x_p1);
LA7_: ;
		T5_ = T6_;
		if (T5_) goto LA8_;
		T5_ = (y_p2 < ((NI)0));
LA8_: ;
		T4_ = T5_;
		if (T4_) goto LA9_;
		T4_ = ((*tb_p0).height <= y_p2);
LA9_: ;
		if (!T4_) goto LA10_;
		colontmp__2.len = 0; colontmp__2.p = NIM_NIL;
		nimln_(132);		defStyle_1.fg = white__srcZtypes_u59();
		if (NIM_UNLIKELY(*nimErr_)) goto LA12_;
		defStyle_1.bg = black__srcZtypes_u45();
		if (NIM_UNLIKELY(*nimErr_)) goto LA12_;
		defStyle_1.bold = NIM_FALSE;
		defStyle_1.underline = NIM_FALSE;
		defStyle_1.italic = NIM_FALSE;
		defStyle_1.dim = NIM_FALSE;
		nimln_(133);		colontmp__2 = TM__YUEZm6l2D5ui6TQWDCivXQ_39;
		colontmp__3 = defStyle_1;
		nimln_(129);		nimln_(133);		blitTmp_1 = colontmp__2;
		nimlf_(1699, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");		eqwasMoved___system_u2707((&colontmp__2));
		(*Result).Field0 = blitTmp_1;
		(*Result).Field1 = colontmp__3;
		nimln_(394);		if (colontmp__2.p && !(colontmp__2.p->cap & NIM_STRLIT_FLAG)) {
 deallocShared(colontmp__2.p);
}
		if (colontmp_.p && !(colontmp_.p->cap & NIM_STRLIT_FLAG)) {
 deallocShared(colontmp_.p);
}
		goto BeforeRet_;
		{
			LA12_:;
		}
		{
			if (colontmp__2.p && !(colontmp__2.p->cap & NIM_STRLIT_FLAG)) {
 deallocShared(colontmp__2.p);
}
		}
		if (NIM_UNLIKELY(*nimErr_)) goto LA1_;
	}
LA10_: ;
	nimlf_(134, "/workspaces/telestorie/backends/terminal/termbuffer.nim");	if (nimMulInt(y_p2, (*tb_p0).width, &TM__YUEZm6l2D5ui6TQWDCivXQ_40)) { raiseOverflow(); goto LA1_;
	};
	if (nimAddInt((NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_40), x_p1, &TM__YUEZm6l2D5ui6TQWDCivXQ_41)) { raiseOverflow(); goto LA1_;
	};
	idx_1 = (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_41);
	nimln_(135);	{
		NIM_BOOL T17_;
		NI T19_;
		NimStringV2 colontmp__4;
		tyObject_Style__UURjArTrf2wmcCbN5MncAQ colontmp__5;
		NimStringV2 blitTmp_2;
		T17_ = (NIM_BOOL)0;
		T17_ = (((NI)0) <= idx_1);
		if (!(T17_)) goto LA18_;
		T19_ = (*tb_p0).cells.len;
		T17_ = (idx_1 < T19_);
LA18_: ;
		if (!T17_) goto LA20_;
		colontmp__4.len = 0; colontmp__4.p = NIM_NIL;
		nimln_(136);		nimlf_(1699, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");		if (idx_1 < 0 || idx_1 >= (*tb_p0).cells.len){ raiseIndexError2(idx_1,(*tb_p0).cells.len-1); goto LA22_;
		}
		eqcopy___system_u2710((&colontmp__4), (*tb_p0).cells.p->data[idx_1].ch);
		nimlf_(136, "/workspaces/telestorie/backends/terminal/termbuffer.nim");		if (idx_1 < 0 || idx_1 >= (*tb_p0).cells.len){ raiseIndexError2(idx_1,(*tb_p0).cells.len-1); goto LA22_;
		}
		colontmp__5 = (*tb_p0).cells.p->data[idx_1].style;
		nimln_(129);		nimln_(136);		blitTmp_2 = colontmp__4;
		nimlf_(1699, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");		eqwasMoved___system_u2707((&colontmp__4));
		(*Result).Field0 = blitTmp_2;
		(*Result).Field1 = colontmp__5;
		nimln_(394);		if (colontmp__4.p && !(colontmp__4.p->cap & NIM_STRLIT_FLAG)) {
 deallocShared(colontmp__4.p);
}
		if (colontmp_.p && !(colontmp_.p->cap & NIM_STRLIT_FLAG)) {
 deallocShared(colontmp_.p);
}
		goto BeforeRet_;
		{
			LA22_:;
		}
		{
			if (colontmp__4.p && !(colontmp__4.p->cap & NIM_STRLIT_FLAG)) {
 deallocShared(colontmp__4.p);
}
		}
		if (NIM_UNLIKELY(*nimErr_)) goto LA1_;
	}
LA20_: ;
	nimlf_(137, "/workspaces/telestorie/backends/terminal/termbuffer.nim");	defStyle_2.fg = white__srcZtypes_u59();
	if (NIM_UNLIKELY(*nimErr_)) goto LA1_;
	defStyle_2.bg = black__srcZtypes_u45();
	if (NIM_UNLIKELY(*nimErr_)) goto LA1_;
	defStyle_2.bold = NIM_FALSE;
	defStyle_2.underline = NIM_FALSE;
	defStyle_2.italic = NIM_FALSE;
	defStyle_2.dim = NIM_FALSE;
	nimln_(138);	colontmp_ = TM__YUEZm6l2D5ui6TQWDCivXQ_42;
	colontmp__6 = defStyle_2;
	nimln_(129);	nimln_(138);	blitTmp_3 = colontmp_;
	nimlf_(1699, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");	eqwasMoved___system_u2707((&colontmp_));
	(*Result).Field0 = blitTmp_3;
	(*Result).Field1 = colontmp__6;
	nimln_(394);	if (colontmp_.p && !(colontmp_.p->cap & NIM_STRLIT_FLAG)) {
 deallocShared(colontmp_.p);
}
	goto BeforeRet_;
	{
		LA1_:;
	}
	{
		if (colontmp_.p && !(colontmp_.p->cap & NIM_STRLIT_FLAG)) {
 deallocShared(colontmp_.p);
}
	}
	if (NIM_UNLIKELY(*nimErr_)) goto BeforeRet_;
	}BeforeRet_: ;
	popFrame();
}
N_LIB_PRIVATE N_NIMCALL(void, compositeBufferOnto__backendsZterminalZtermbuffer_u364)(tyObject_TermBuffer__a0me0i7S30c79coeAcFBkWw* dest_p0, tyObject_TermBuffer__a0me0i7S30c79coeAcFBkWw* src_p1) {
	NI w_1;
	NI h_1;
	nimfr_("compositeBufferOnto", "/workspaces/telestorie/backends/terminal/termbuffer.nim");
{	nimlf_(143, "/workspaces/telestorie/backends/terminal/termbuffer.nim");	w_1 = (((*dest_p0).width <= (*src_p1).width) ? (*dest_p0).width : (*src_p1).width);
	nimln_(144);	h_1 = (((*dest_p0).height <= (*src_p1).height) ? (*dest_p0).height : (*src_p1).height);
	{
		NI y_1;
		NI i_1;
		y_1 = (NI)0;
		nimlf_(128, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system/iterators_1.nim");		i_1 = ((NI)0);
		{
			nimln_(129);			while (1) {
				NI dr_1;
				NI TM__YUEZm6l2D5ui6TQWDCivXQ_43;
				NI sr_1;
				NI TM__YUEZm6l2D5ui6TQWDCivXQ_44;
				NI TM__YUEZm6l2D5ui6TQWDCivXQ_48;
				if (!(i_1 < h_1)) goto LA3;
				nimlf_(145, "/workspaces/telestorie/backends/terminal/termbuffer.nim");				y_1 = i_1;
				nimln_(146);				if (nimMulInt(y_1, (*dest_p0).width, &TM__YUEZm6l2D5ui6TQWDCivXQ_43)) { raiseOverflow(); goto BeforeRet_;
				};
				dr_1 = (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_43);
				nimln_(147);				if (nimMulInt(y_1, (*src_p1).width, &TM__YUEZm6l2D5ui6TQWDCivXQ_44)) { raiseOverflow(); goto BeforeRet_;
				};
				sr_1 = (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_44);
				{
					NI x_1;
					NI i_2;
					x_1 = (NI)0;
					nimlf_(128, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system/iterators_1.nim");					i_2 = ((NI)0);
					{
						nimln_(129);						while (1) {
							tyObject_Cell__cmvwxiDU9cRtyqddD9c1iMTA s_1;
							NI TM__YUEZm6l2D5ui6TQWDCivXQ_45;
							NI TM__YUEZm6l2D5ui6TQWDCivXQ_47;
							if (!(i_2 < w_1)) goto LA6;
							nimZeroMem((void*)(&s_1), sizeof(tyObject_Cell__cmvwxiDU9cRtyqddD9c1iMTA));
							nimlf_(148, "/workspaces/telestorie/backends/terminal/termbuffer.nim");							x_1 = i_2;
							nimlf_(934, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");							nimlf_(149, "/workspaces/telestorie/backends/terminal/termbuffer.nim");							if (nimAddInt(sr_1, x_1, &TM__YUEZm6l2D5ui6TQWDCivXQ_45)) { raiseOverflow(); goto BeforeRet_;
							};
							if ((NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_45) < 0 || (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_45) >= (*src_p1).cells.len){ raiseIndexError2((NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_45),(*src_p1).cells.len-1); goto BeforeRet_;
							}
							nimlf_(934, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");							eqcopy___backendsZterminalZtermbuffer_u110((&s_1), (&(*src_p1).cells.p->data[(NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_45)]));
							nimlf_(151, "/workspaces/telestorie/backends/terminal/termbuffer.nim");							{
								NIM_BOOL T9_;
								NIM_BOOL T11_;
								NIM_BOOL T12_;
								NI TM__YUEZm6l2D5ui6TQWDCivXQ_46;
								T9_ = (NIM_BOOL)0;
								T9_ = (((NI)0) < s_1.ch.len);
								if (T9_) goto LA10_;
								T11_ = (NIM_BOOL)0;
								T12_ = (NIM_BOOL)0;
								T12_ = !((s_1.style.bg.r == ((NU8)0)));
								if (T12_) goto LA13_;
								T12_ = !((s_1.style.bg.g == ((NU8)0)));
LA13_: ;
								T11_ = T12_;
								if (T11_) goto LA14_;
								T11_ = !((s_1.style.bg.b == ((NU8)0)));
LA14_: ;
								T9_ = T11_;
LA10_: ;
								if (!T9_) goto LA15_;
								nimlf_(934, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");								nimlf_(152, "/workspaces/telestorie/backends/terminal/termbuffer.nim");								if (nimAddInt(dr_1, x_1, &TM__YUEZm6l2D5ui6TQWDCivXQ_46)) { raiseOverflow(); goto BeforeRet_;
								};
								if ((NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_46) < 0 || (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_46) >= (*dest_p0).cells.len){ raiseIndexError2((NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_46),(*dest_p0).cells.len-1); goto BeforeRet_;
								}
								nimlf_(934, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");								eqsink___backendsZterminalZtermbuffer_u116((&(*dest_p0).cells.p->data[(NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_46)]), (&s_1));
								eqwasMoved___backendsZterminalZtermbuffer_u104((&s_1));
							}
LA15_: ;
							nimlf_(131, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system/iterators_1.nim");							if (nimAddInt(i_2, ((NI)1), &TM__YUEZm6l2D5ui6TQWDCivXQ_47)) { raiseOverflow(); goto BeforeRet_;
							};
							i_2 = (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_47);
							nimlf_(934, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system.nim");							eqdestroy___backendsZterminalZtermbuffer_u107((&s_1));
						} LA6: ;
					}
				}
				nimlf_(131, "/home/codespace/.choosenim/toolchains/nim-2.2.6/lib/system/iterators_1.nim");				if (nimAddInt(i_1, ((NI)1), &TM__YUEZm6l2D5ui6TQWDCivXQ_48)) { raiseOverflow(); goto BeforeRet_;
				};
				i_1 = (NI)(TM__YUEZm6l2D5ui6TQWDCivXQ_48);
			} LA3: ;
		}
	}
	}BeforeRet_: ;
	popFrame();
}
